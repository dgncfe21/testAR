<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Geolocation App</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs>
        <!-- Location 1 -->
        <a-entity gps-entity-place="Latitude: 25.69920755459637,Longitude: -100.31762767193608;">
            <!-- Your content for Location 1 -->
            <a-image src="img1.jpg" scale="1 1 1"></a-image>
        </a-entity>

        <!-- Location 2 -->
        <a-entity gps-entity-place="Latitude: 25.69920755459637,Longitude:  -100.31767508714103;">
            <!-- Your content for Location 2 -->
            <a-video src="img2.jpg" scale="1 1 1"></a-video>
        </a-entity>

        <!-- Add more locations as needed -->

      <!-- Handle camera and scene lighting -->
        <a-entity camera></a-entity>
        <a-light type="ambient" position="0 5 0" intensity="0.5"></a-light>
    </a-scene>

    <script>
        // Handle geolocation
        navigator.geolocation.getCurrentPosition((position) => {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;

            // Update the positions and scales of the gps-entity-place components
            document.querySelectorAll('[gps-entity-place]').forEach((element) => {
                const coordinates = element.getAttribute('gps-entity-place');
                const distance = calculateDistance(latitude, longitude, coordinates.latitude, coordinates.longitude);
                
                // Adjust the scale based on the distance
                const scale = calculateScale(distance);
                
                // Update the gps-entity-place attributes
                element.setAttribute('gps-entity-place', `latitude: ${latitude}; longitude: ${longitude};`);
                
                // Update the scale of child entities
                element.querySelectorAll('[scale]').forEach((child) => {
                    child.setAttribute('scale', `${scale} ${scale} ${scale}`);
                });
            });
        });

        // Function to calculate the distance between two sets of coordinates
        function calculateDistance(lat1, lon1, lat2, lon2) {
            // This is a basic implementation and doesn't account for curvature of the Earth
            const R = 6371; // Radius of the Earth in kilometers
            const dLat = (lat2 - lat1) * (Math.PI / 180);
            const dLon = (lon2 - lon1) * (Math.PI / 180);
            const a =
                Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                Math.cos(lat1 * (Math.PI / 180)) * Math.cos(lat2 * (Math.PI / 180)) *
                Math.sin(dLon / 2) * Math.sin(dLon / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            const distance = R * c;
            return distance;
        }

        // Function to calculate scale based on distance
        function calculateScale(distance) {
            // You can adjust this function based on your needs
            const minScale = 0.1; // Minimum scale
            const maxScale = 2.0; // Maximum scale
            const scaleFactor = 0.01; // Adjust this factor based on testing

            // Scale increases with the reciprocal of the distance
            const scale = 1 / distance * scaleFactor;

            // Clamp the scale between minScale and maxScale
            return Math.min(Math.max(scale, minScale), maxScale);
        }
    </script>
</body>
</html>
